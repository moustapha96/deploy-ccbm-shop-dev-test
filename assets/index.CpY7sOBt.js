import{P as y,u as N,j as e,R as v,l as w,m as C,n as T,h as k,i as q,o as F,L as S,p as A}from"./index.CW09QBtC.js";import{b as p,c as M,u as E}from"./vendor.EKSpuOPe.js";function L({className:t,filterToggle:c,updateUrlParams:n,type:m=3}){const{filters:s,updateFilters:r}=p.useContext(y),{user:i}=N(),d=a=>{r({...s,min:a[0],max:a[1],page:1}),n({...s,min:a[0],max:a[1],page:1})},x=a=>{const o=a.target.value;r({...s,productType:o,page:1}),n({...s,productType:o,page:1})},g=a=>{const o=a.target.value;r({...s,tag:o,page:1}),n({...s,tag:o,page:1})},[b,f]=p.useState([]);return p.useEffect(()=>{(async()=>{try{const o=await w.getTags();f(o),console.log(o)}catch(o){console.error("Erreur lors de la récupération des catégories",o)}})()},[]),e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${t||""} ${c?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Type de produits"})}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-qgray",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"All",name:"productType",checked:s.productType==="All",onChange:x}),"Tous les produits"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"promo",name:"productType",checked:s.productType==="promo",onChange:x}),"Produits en promo"]}),i&&i.adhesion=="accepted"&&i.parent_id&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"credit",name:"productType",checked:s.productType==="credit",onChange:x}),"Produits à crédit"]})]})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:s.tag||"",onChange:g,children:[e.jsx("option",{value:"",children:"Tous les tags"}),b.map(a=>e.jsx("option",{value:a.slug||a.name,children:a.name},a.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(v,{value:[s.min,s.max],onInput:d,min:4e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",s.min," - ",s.max]})]})]})}const I=({currentPage:t,totalPages:c,onPageChange:n})=>{const m=()=>{const r=[];for(let i=Math.max(2,t-2);i<=Math.min(c-1,t+2);i++)r.push(i);return t-2>2&&r.unshift("..."),t+2<c-1&&r.push("..."),r.unshift(1),c!==1&&r.push(c),r};return e.jsx("nav",{className:"flex justify-center items-center mt-8 px-4","aria-label":"Pagination",children:e.jsxs("ul",{className:"flex flex-wrap justify-center items-center space-x-1 md:space-x-2",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>n(Math.max(1,t-1)),disabled:t===1,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(C,{className:"w-5 h-5"})})}),m().map((s,r)=>e.jsx("li",{children:typeof s=="number"?e.jsx("button",{onClick:()=>n(s),className:`hidden sm:block px-3 py-2 rounded ${t===s?"bg-bleu-logo text-white":"bg-gray-200 text-gray-700 hover:bg-qyellow"}`,"aria-current":t===s?"page":void 0,children:s}):e.jsx("span",{className:"hidden sm:block px-3 py-2",children:s})},r)),e.jsx("li",{className:"sm:hidden",children:e.jsxs("span",{className:"px-3 py-2 text-gray-700",children:[t," / ",c]})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>n(Math.min(c,t+1)),disabled:t===c,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(T,{className:"w-5 h-5"})})})]})})};function B(){const{currentProducts:t,totalProducts:c,isLoadingProduct:n,fetchProducts:m,updateFilters:s,resetFilters:r,filters:i}=p.useContext(y),d=M(),x=E();p.useEffect(()=>{r();const l=new URLSearchParams(d.search),h={page:Number.parseInt(l.get("page"))||1,category:l.get("category")||"All",search:l.get("search")||"",min:Number.parseInt(l.get("min"))||1e3,max:Number.parseInt(l.get("max"))||5e6,limit:9,productType:l.get("productType")||"All",tag:l.get("tag")||"All"};s(h),window.scrollTo({top:0,left:100,behavior:"smooth"})},[d.pathname,d.search,r,s]),p.useEffect(()=>{m()},[m]);const g=(i.page-1)*i.limit+1,b=Math.min(i.page*i.limit,c),f=l=>{o({...i,page:l}),window.scrollTo({top:0,left:100,behavior:"smooth"})},a=l=>{o({category:l||"All",page:1}),window.scrollTo({top:0,left:100,behavior:"smooth"})},o=p.useCallback(l=>{const h=new URLSearchParams(d.search);Object.entries(l).forEach(([j,u])=>{u!=null&&u!==""?h.set(j,u.toString()):h.delete(j)}),x({search:h.toString()},{replace:!0})},[d.search,x]);return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"CCBM Shop | Boutique",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité.",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(q,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(F,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(L,{handleCategoryChange:a,updateUrlParams:o})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",c>0?`${g}–${b} sur ${c} résultats`:"0 résultat"]})}),n?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(S,{className:"animate-spin"})," Chargement"]}):t.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Pas de produits disponible pour le moment"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:t.map(l=>e.jsx(A,{datas:l},l.id))}),e.jsx(I,{currentPage:i.page,totalPages:Math.ceil(c/i.limit),onPageChange:f})]})]})]})})})]})}export{B as default};
